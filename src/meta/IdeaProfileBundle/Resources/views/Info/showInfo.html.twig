{% extends 'metaIdeaProfileBundle:Default:show.html.twig' %}

{% block title %}{{ parent() }} > {{ base.idea.name }} | Info{% endblock %}

{% block content %}
<section>
  <div class="wmd-heading"><i class="icon-bullhorn"></i> About this idea {% if base.canEdit %}<a class="pull-right markdown-trigger">&hellip;<i class="icon-pencil"></i></a>{% endif %}</div>
  <div>

      <div class="wmd-message-top hide alert"><i class="icon-warning-sign"></i> Unsaved changes</div>
      <div class="wmd-wrapper well well-small hide" >
        <div class="wmd-panel">
            <div id="wmd-button-bar"></div>
            <textarea unsaved='no' data-name="about" data-url="{{ path('i_edit_idea', {'id': base.idea.id, 'token': csrf_token('edit') }) }}" class="wmd-input" id="wmd-input">{{ base.idea.about }}</textarea>
        </div>
        <div>
          <button id="wmd-save" class="btn btn-primary">Save</button> <span class="muted wmd-message">Click 'Save' to commit your changes</span>
        </div>
        <div id="wmd-preview" class="preview">{{ base.idea.about }}</div>
      </div>

    <div class="content">{{ base.idea.about|deeplinks|markdown }}</div>

  </div>
</section>
<section class="colored">
  <div class="sectionTitle">Creators : </div>
  <ul class="users sectionContent">
  {% for creatorUser in base.idea.creators %}
      <li>
        <a href="{{ path('u_show_user_profile', {'username': creatorUser.username}) }}">
          <img src="{{ creatorUser.avatar }}" width="70" height="70" class="smallAvatar"/>
          <div class="smallObjectInfos">
            <span><div>{{ creatorUser.firstName }}</div><div>{{ creatorUser.lastName|upper }}</div></span>
          </div>
        </a>
      </li>
  {% endfor %}
  </ul>
</section>
<section class="colored">
  <div class="sectionTitle">{% if base.idea.participants|length > 0 or base.isCreator %}Participants : {% else %}No participant yet ...{% endif %}</div>
  <ul class="users sectionContent">
  {% for participatingUser in base.idea.participants %}
      <li>
        <a href="{{ path('u_show_user_profile', {'username': participatingUser.username}) }}">
          <img src="{{ participatingUser.avatar }}" width="70" height="70" class="smallAvatar"/>
          <div class="smallObjectInfos">
            <span><div>{{ participatingUser.firstName }}</div><div>{{ participatingUser.lastName|upper }}</div></span>
          </div>
        </a>
        {% if base.isCreator %}<a class="removeUserIcon" href="{{ path('i_remove_participant_to_idea', { 'id': base.idea.id, 'username' : participatingUser.username, 'token': csrf_token('removeParticipant') }) }}"><i class="icon-remove-sign icon-large"></i></a>{% endif %}
      </li>
  {% endfor %}
  {% if base.canEdit %}
      <li>
        <a href="{{ path('u_choose_user', {'targetAsBase64': targetParticipantAsBase64, 'token': csrf_token('addParticipant')  }) }}">
          <div class="smallTextAvatar"><i class="icon-plus-sign"></i></div>
          <div class="smallObjectInfos">
            <span>Add a Participant</span>
          </div>
        </a>
      </li>
  {% endif %}
  </ul>
</section>
{% if base.isCreator %}
<section class="colored warning">
  <div class="sectionTitle">Delete this idea : </div>
  <div class="sectionContent"><a class="btn btn-danger" data-confirm="Are you sure you want to delete this idea ?" href="{{ path('i_delete_idea', { 'id': base.idea.id, 'token': csrf_token('delete') }) }}">Delete</a> <span class="muted">( <i class="icon-warning-sign"></i> Warning : you cannot undo this )</span></div>
</section>
{% endif %}
{% endblock %}