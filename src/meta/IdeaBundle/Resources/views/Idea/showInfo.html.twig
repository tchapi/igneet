{% extends 'metaIdeaBundle:Idea:show.html.twig' %}

{% block title %}{{ parent() }} | {{ "idea.info.title"|trans }}{% endblock %}

{% block content %}
<section>
  <div class="wmd-heading"><i class="fa fa-bullhorn"></i> {{ "idea.info.about"|trans }} {% if base.canEdit %}<a class="pull-right markdown-trigger">&hellip;<i class="fa fa-pencil"></i></a>{% endif %}</div>
  <div>

      <div class="wmd-message-top alert alert-warning" style="display: none;"><i class="fa fa-warning"></i> {{ "unsaved.changes"|trans }}</div>
      <div class="wmd-wrapper well well-small" style="display: none;">
        <div class="wmd-panel">
            <div id="wmd-button-bar"></div>
            <textarea unsaved='no' data-name="about" data-url="{{ path('i_edit_idea', {'uid': base.idea.id|to_uid, 'token': csrf_token('edit') }) }}" class="wmd-input" id="wmd-input">{{ base.idea.about }}</textarea>
        </div>
        <div>
          <button id="wmd-save" class="btn btn-primary">{{ "save"|trans }}</button> <span class="muted wmd-message">{{ "saveHelp"|trans }}</span>
        </div>
        <div id="wmd-preview" class="preview">{{ base.idea.about }}</div>
      </div>

    <div class="content">{{ base.idea.about|deeplinks|markdown }}</div>

  </div>
</section>
<section class="colored">
  <div class="sectionTitle">{{ "idea.info.creators"|trans }} : </div>
  <ul class="users sectionContent">
  {% for creatorUser in base.idea.creators %}
    {% if not creatorUser.isDeleted %}
      <li>
        <a href="{{ path('u_show_user_profile', {'username': creatorUser.username}) }}">
          <img src="{{ creatorUser.avatar }}" width="70" height="70" class="smallAvatar"/>
          <div class="smallObjectInfos ellipsis-multiline">
            <span><div>{{ creatorUser.firstName }}</div><div>{{ creatorUser.lastName }}</div></span>
          </div>
        </a>
      </li>
    {% endif %}
  {% endfor %}
  </ul>
</section>
{% if base.idea.community is not null %}
<section class="colored">
  <div class="sectionTitle">{% transchoice base.idea.countParticipants %}idea.info.participants{% endtranschoice %} </div>
  <ul class="users sectionContent">
  {% for participatingUser in base.idea.participants %}
    {% if not participatingUser.isDeleted %}
      <li>
        <a href="{{ path('u_show_user_profile', {'username': participatingUser.username}) }}">
          <img src="{{ participatingUser.avatar }}" width="70" height="70" class="smallAvatar"/>
          <div class="smallObjectInfos ellipsis-multiline">
            <span><div>{{ participatingUser.firstName }}</div><div>{{ participatingUser.lastName }}</div></span>
          </div>
        </a>
        {% if base.isCreator %}<a class="removeUserIcon" href="{{ path('i_remove_participant_to_idea', { 'uid': base.idea.id|to_uid, 'username' : participatingUser.username, 'token': csrf_token('removeParticipant') }) }}"><i class="fa fa-times fa-lg"></i></a>{% endif %}
      </li>
    {% endif %}
  {% endfor %}
  {% if base.canEdit %}
      <li>
        <a href="{{ path('u_choose_user', {'targetAsBase64': targetParticipantAsBase64, 'token': csrf_token('addParticipant')  }) }}">
          <div class="smallTextAvatar"><i class="fa fa-plus-circle"></i></div>
          <div class="smallObjectInfos ellipsis-multiline">
            <span>{{ "idea.info.add.participant"|trans }}</span>
          </div>
        </a>
      </li>
  {% endif %}
  </ul>
</section>
{% endif %}
{% if base.isCreator %}
<section class="colored warning">
  <div class="sectionTitle">{{ "idea.delete"|trans }} : </div>
  <div class="sectionContent"><a class="btn btn-danger" data-confirm="{{ "idea.deleteHelp"|trans }}" href="{{ path('i_delete_idea', { 'uid': base.idea.id|to_uid, 'token': csrf_token('delete') }) }}">{{ "delete"|trans }}</a> <span class="muted">( <i class="fa fa-warning"></i> {{ "deleteHelp"|trans }} )</span></div>
</section>
{% endif %}
{% endblock %}